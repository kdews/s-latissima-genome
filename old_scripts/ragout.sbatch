#!/bin/bash
#SBATCH -J ragout
#SBATCH -p meb_largemem
#SBATCH --mem=230gb
#SBATCH --time=7-0
#SBATCH --cpus-per-task=12
#SBATCH -o %x.log

# Print date and time
date

# Load conda and Ragout env
cond=~/.conda_for_sbatch.sh
[[ -a "$cond" ]] && source "$cond" || \
{ echo "Error on source of $cond"; exit 1; }
conda activate ragout

# Help message
if [[ $1 == "-h" ]] || [[ $1 == "--help" ]]
then
  echo "\
Runs Ragout in large assembly mode on HAL file generated by Cactus.
Usage: sbatch ${SLURM_JOB_NAME}.sbatch
Requires: Ragout (https://github.com/fenderglass/Ragout)"
  exit 0
fi


# Define variables
recipe_file=s_lat_rag.rcp
assembly_no_ext=$(basename "${assembly%.*}")
# Output directory name
out="${SLURM_JOB_NAME}_${assembly_no_ext}"

cmd="ragout -s hal $recipe_file"
echo "$cmd"
$cmd
